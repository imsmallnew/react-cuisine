import{a as y,c as w,u as k,r as m,s as p,d as c,p as l,h as g,j as s,L,N as $}from"./index-Tq8liahp.js";import{T as A,l as D}from"./logo-DejucHek.js";import"./bootstrap.esm-CPbp9n-C.js";function E(){const r="https://ec-course-api.hexschool.io",t=y(),d=w(),{isLoading:f,loadingText:j}=k(e=>e.loading),[i,v]=m.useState({username:"",password:""}),b=async e=>{var n,a;e.preventDefault(),t(p("讀取中..."));try{const o=await c.post(`${r}/v2/admin/signin`,i),{token:x,expired:N}=o.data;document.cookie=`reactHWToken=${x}; expires=${new Date(N)}`,c.defaults.headers.common.Authorization=x,t(l({title:"系統提示",text:"驗證登入成功, 歡迎進入商品管理後台",status:"success"})),d("/admin")}catch(o){t(l({title:"系統提示",text:((a=(n=o==null?void 0:o.response)==null?void 0:n.data)==null?void 0:a.message)||`使用者 ${i.username} 登入失敗`,status:"failed"}))}finally{t(g())}},h=m.useCallback(async()=>{var e,n;t(p("讀取中..."));try{await c.post(`${r}/v2/api/user/check`),t(l({title:"系統提示",text:"驗證登入成功, 歡迎進入商品管理後台",status:"success"})),d("/admin")}catch(a){console.error(a),t(l({title:"系統提示",text:((n=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:n.message)||(a==null?void 0:a.message),status:"failed"}))}finally{t(g())}},[r,t,d]);m.useEffect(()=>{const e=document.cookie.replace(/(?:(?:^|.*;\s*)reactHWToken\s*=\s*([^;]*).*$)|^.*$/,"$1");e.length>0&&(c.defaults.headers.common.Authorization=e,h())},[h]);const u=e=>{const{name:n,value:a}=e.target;v({...i,[n]:a})};return s.jsxs(s.Fragment,{children:[f&&s.jsx(L,{loadingText:j}),s.jsx(A,{}),s.jsx("nav",{className:"navbar navbar-light navbar-expand text-primary navbar-toggleable fixed-top shadow bg-dark","data-bs-theme":"dark",children:s.jsxs("div",{className:"container",children:[s.jsxs("a",{className:"navbar-brand site-title",children:[s.jsx("img",{src:D,style:{width:50,marginRight:"5px"}})," Daniel's Burger Admin"]}),s.jsx("div",{className:"d-flex",children:s.jsx($,{to:"/",className:({isActive:e})=>`btn btn-sm ${e?"btn-secondary":"btn-outline-secondary"} me-2`,children:"返回首頁"})})]})}),s.jsx("div",{className:"container",children:s.jsx("div",{className:"container-fluid",children:s.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center vh-100",children:[s.jsx("h1",{className:"mb-5",children:"商品管理系統"}),s.jsxs("form",{onSubmit:b,className:"d-flex flex-column gap-3",children:[s.jsxs("div",{className:"form-floating mb-3",children:[s.jsx("input",{type:"email",name:"username",onChange:u,className:"form-control",id:"username",placeholder:"",value:i.username}),s.jsx("label",{htmlFor:"username",children:"Email address"})]}),s.jsxs("div",{className:"form-floating",children:[s.jsx("input",{type:"password",name:"password",onChange:u,className:"form-control",id:"password",placeholder:"",value:i.password}),s.jsx("label",{htmlFor:"password",children:"Password"})]}),s.jsx("button",{className:"btn btn-primary",children:"登入"})]}),s.jsx("p",{className:"mt-5 mb-3 text-muted",children:"© 2024 - Daniel's Burger All Rights Reserved."})]})})})]})}export{E as default};
