import{a as $,r as i,s as S,d as y,p as m,h as R,j as e,e as w,R as A,g as H}from"./index-BHl6oezR.js";import{h as n}from"./proxy-DPAYpB0g.js";import{A as I}from"./index-AGjYwUS9.js";function z(){const d="https://ec-course-api.hexschool.io",x="imsmallnew",s=$(),[r,v]=i.useState({}),[u,h]=i.useState(!1),[a,N]=i.useState(null),[k]=i.useState("menu"),[o,g]=i.useState(null),p=o?a==null?void 0:a.filter(t=>t.category===o):a,f=i.useCallback(async()=>{s(S("讀取中..."));try{let l=(await y.get(`${d}/v2/api/${x}/products/all`)).data.products;N(l)}catch(t){console.error(t),s(m({title:"取得商品列表失敗",text:t==null?void 0:t.message,status:"failed"}))}finally{s(R())}},[d,x,s]);i.useEffect(()=>{f()},[k,f]);const C=async(t,l)=>{var b,j;v(t),h(!0);try{await y.post(`${d}/v2/api/${x}/cart`,{data:{product_id:t.id,qty:Number(l)}}),s(H(!1)),s(m({title:"更新數量成功",text:`[${t.title}] 已加入購物車 ${l} ${t.unit}`,status:"success"})),h(!1)}catch(c){s(m({title:"更新數量失敗",text:((j=(b=c==null?void 0:c.response)==null?void 0:b.data)==null?void 0:j.message)||`[${t.title}] 加到購物車失敗`,status:"failed"})),console.error(c)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container-fluid",style:{backgroundImage:"url('https://images.unsplash.com/photo-1491960693564-421771d727d6?q=80&w=2863&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D')",backgroundSize:"cover",backgroundPosition:"center",minHeight:"100vh",position:"relative",paddingTop:"70px"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.2)",zIndex:1}}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"d-flex flex-md-column flex-row col-12 col-md-2 d-md-block category-list",children:e.jsxs("ul",{className:"list-group list-group-horizontal-md list-group-flush flex-md-column flex-row w-100 text-center",children:[e.jsx(n.li,{className:`list-group-item ${o===null?"active bg-warning text-dark":""}`,onClick:()=>g(null),style:{cursor:"pointer",backgroundColor:"transparent",color:"#fff",border:"none"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},children:"全部商品"}),[...new Set(a==null?void 0:a.map(t=>t.category))].map((t,l)=>e.jsx(n.li,{className:`list-group-item ${o===t?"active bg-warning text-dark":""}`,onClick:()=>g(t),style:{cursor:"pointer",backgroundColor:"transparent",color:"#fff",border:"none"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:l*.1,duration:.5},children:t},t))]})}),e.jsx("div",{className:"col-12 col-md-10 offset-md-2 ps-4 pe-4 mt-md-0 mt-5 pt-3",style:{zIndex:10},children:e.jsx(I,{mode:"wait",children:e.jsx(n.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},className:"row mt-4",children:p==null?void 0:p.map(t=>e.jsx("div",{className:"col-12 col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3",children:e.jsxs(n.div,{className:"card h-100",whileHover:{scale:1.02},transition:{duration:.3},style:{background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(10px)",boxShadow:"0 4px 10px rgba(0,0,0,0.3)",borderRadius:"10px",overflow:"hidden",padding:"10px",paddingBottom:"5px"},children:[e.jsx(w,{to:`/products/${t.id}`,children:e.jsx("div",{className:"overflow-hidden",style:{height:"250px",borderRadius:"10px",position:"relative"},children:e.jsx(n.img,{src:t==null?void 0:t.imageUrl,alt:"商品圖片",className:"card-img-top",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px",position:"absolute",top:"0",left:"0",transformOrigin:"center"},whileHover:{scale:1.05},transition:{duration:.3}})})}),e.jsxs("div",{className:"card-body text-center text-white",children:[e.jsx("h4",{className:"card-title",children:t.title}),e.jsx("span",{className:"badge bg-danger me-1 mt-1",style:{verticalAlign:"top"},children:t.category}),e.jsxs("h4",{className:"text-warning d-inline",children:[" ",t.price," 元 "]}),e.jsx("h6",{className:"text-light d-inline",children:e.jsxs("del",{children:[t.origin_price," 元"]})})]}),e.jsxs("div",{className:"card-footer d-flex",children:[e.jsxs(w,{className:"btn btn-outline-light w-50 d-flex justify-content-center align-items-center",to:`/products/${t.id}`,children:[e.jsx("i",{className:"fas fa-search me-2"})," 商品詳情"]}),e.jsxs("button",{type:"button",className:"btn btn-outline-warning w-50 d-flex justify-content-center align-items-center ms-2",onClick:()=>C(t,1),disabled:r&&u&&t.id===r.id,children:[e.jsx("div",{className:"d-flex align-items-center",children:r&&u&&t.id===r.id?e.jsx(A,{type:"spin",color:"#FFD700",height:"1rem",width:"1rem",className:"d-flex"}):e.jsx("i",{className:"fa-solid fa-cart-shopping"})}),e.jsx("span",{className:"ms-2",children:"加入購物車"})]})]})]})},t.id))},o)})})]})]})})}export{z as default};
