import{a as y,c as N,u as D,r as m,s as p,d as o,p as l,h as g,j as s,L as k,N as T}from"./index-BqobUboi.js";import{T as L}from"./Toast-D-jWdCZd.js";import"./bootstrap.esm-CPbp9n-C.js";function E(){const r="https://ec-course-api.hexschool.io",t=y(),d=N(),{isLoading:f,loadingText:v}=D(e=>e.loading),[i,b]=m.useState({username:"",password:""}),j=async e=>{var n,a;e.preventDefault(),t(p("讀取中..."));try{const c=await o.post(`${r}/v2/admin/signin`,i),{token:x,expired:w}=c.data;document.cookie=`reactHWToken=${x}; expires=${new Date(w)}`,o.defaults.headers.common.Authorization=x,t(l({title:"系統提示",text:"驗證登入成功, 歡迎進入商品管理後台",status:"success"})),d("/admin")}catch(c){t(l({title:"系統提示",text:((a=(n=c==null?void 0:c.response)==null?void 0:n.data)==null?void 0:a.message)||`使用者 ${i.username} 登入失敗`,status:"failed"}))}finally{t(g())}},u=m.useCallback(async()=>{var e,n;t(p("讀取中..."));try{await o.post(`${r}/v2/api/user/check`),t(l({title:"系統提示",text:"驗證登入成功, 歡迎進入商品管理後台",status:"success"})),d("/admin")}catch(a){console.error(a),t(l({title:"系統提示",text:((n=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:n.message)||(a==null?void 0:a.message),status:"failed"}))}finally{t(g())}},[r,t,d]);m.useEffect(()=>{const e=document.cookie.replace(/(?:(?:^|.*;\s*)reactHWToken\s*=\s*([^;]*).*$)|^.*$/,"$1");e.length>0&&(o.defaults.headers.common.Authorization=e,u())},[u]);const h=e=>{const{name:n,value:a}=e.target;b({...i,[n]:a})};return s.jsxs(s.Fragment,{children:[f&&s.jsx(k,{loadingText:v}),s.jsx(L,{}),s.jsx("nav",{className:"navbar navbar-light navbar-expand text-primary navbar-toggleable fixed-top shadow bg-dark","data-bs-theme":"dark",children:s.jsxs("div",{className:"container",children:[s.jsxs("a",{className:"navbar-brand site-title",children:[s.jsx("img",{src:"https://storage.googleapis.com/vue-course-api.appspot.com/imsmallnew/1740577531932.png?GoogleAccessId=firebase-adminsdk-zzty7%40vue-course-api.iam.gserviceaccount.com&Expires=1742169600&Signature=hacFYUa9Ch66uvhPKL0%2FmE5%2BmOwT4bwuA6gRYAxMZCXJE3p9Yvq9CjWXXfLZ0MRO%2FIOur7bocEHtSYJtQRu76ou1n3WPXja1T2Dw89JmiRAqcWye7wTvenzth%2FTL5KX2%2FtfrPDJRQD1B0SDJA8%2Fq5uTs7IjplfCX2JyTipZ4gKs3JcfuhEKhA0CzxTmHd3U%2BGun8TCBiokVdkY%2BulezROsPDKxy9xMrxYi39JXS%2B1xS3XhXim7t7VOxY1ncZ9zL3VuBb8y2TuiI5Dc0Sr8DOa2uGZVQ9uQlawag0PtgjbtD6%2FifZcKxCDbTnEM57vR9zEUf9ud%2FlhrwOIWAnl9XGDQ%3D%3D",style:{width:50,marginRight:"5px"}})," Daniel's Burger Admin"]}),s.jsx("div",{className:"d-flex",children:s.jsx(T,{to:"/",className:({isActive:e})=>`btn btn-sm ${e?"btn-secondary":"btn-outline-secondary"} me-2`,children:"返回首頁"})})]})}),s.jsx("div",{className:"container",children:s.jsx("div",{className:"container-fluid",children:s.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center vh-100",children:[s.jsx("h1",{className:"mb-5",children:"商品管理系統"}),s.jsxs("form",{onSubmit:j,className:"d-flex flex-column gap-3",children:[s.jsxs("div",{className:"form-floating mb-3",children:[s.jsx("input",{type:"email",name:"username",onChange:h,className:"form-control",id:"username",placeholder:"",value:i.username}),s.jsx("label",{htmlFor:"username",children:"Email address"})]}),s.jsxs("div",{className:"form-floating",children:[s.jsx("input",{type:"password",name:"password",onChange:h,className:"form-control",id:"password",placeholder:"",value:i.password}),s.jsx("label",{htmlFor:"password",children:"Password"})]}),s.jsx("button",{className:"btn btn-primary",children:"登入"})]}),s.jsx("p",{className:"mt-5 mb-3 text-muted",children:"© 2024 - Daniel's Burger All Rights Reserved."})]})})})]})}export{E as default};
